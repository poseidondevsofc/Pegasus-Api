<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Pegasus Chat</title>
  <style>
    body {
      background: #000;
      color: #0f0;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      height: 100vh;
    }
    header {
      padding: 12px;
      background: #111;
      text-align: center;
      font-weight: bold;
      border-bottom: 2px solid #0f0;
    }
    #chat {
      flex: 1;
      overflow-y: auto;
      padding: 12px;
    }
    #controls {
      display: flex;
      gap: 8px;
      padding: 12px;
      background: #111;
      border-top: 2px solid #0f0;
    }
    select, input, button {
      padding: 8px;
      border-radius: 6px;
      border: none;
      font-size: 14px;
    }
    select, input {
      flex: 1;
    }
    button {
      background: #0f0;
      color: #000;
      font-weight: bold;
      cursor: pointer;
    }
    .msg {
      margin: 6px 0;
      padding: 8px 12px;
      border-radius: 8px;
    }
    .user {
      background: #0f0;
      color: #000;
      text-align: right;
    }
    .bot {
      background: #111;
      border: 1px solid #0f0;
      color: #0f0;
    }
    a {
      color: #0ff;
      text-decoration: none;
    }
  </style>
</head>
<body>
  <header>‚ö° Pegasus Chat ‚Äî by Poseidon Devs</header>
  <div id="chat"></div>

  <div id="controls">
    <select id="service">
      <option value="gemini">ü§ñ Gemini</option>
      <option value="pinterest">üìå Pinterest</option>
      <option value="youtube">‚ñ∂Ô∏è YouTube</option>
      <option value="google">üîé Google Search</option>
    </select>
    <input type="text" id="prompt" placeholder="Digite sua consulta..." />
    <button id="send">Enviar</button>
  </div>

  <script>
    const chatBox = document.getElementById("chat");
    const promptInput = document.getElementById("prompt");
    const serviceSelect = document.getElementById("service");
    const sendBtn = document.getElementById("send");

    // Salvar a chave Gemini na sess√£o
    async function getGeminiKey() {
      let key = sessionStorage.getItem("pegasus_gemini_key");
      if (!key) {
        key = prompt("‚ö†Ô∏è Informe sua API Key do Gemini:");
        if (key) sessionStorage.setItem("pegasus_gemini_key", key);
      }
      return key;
    }

    function addMessage(text, sender = "bot") {
      const msg = document.createElement("div");
      msg.className = "msg " + sender;
      msg.innerHTML = text;
      chatBox.appendChild(msg);
      chatBox.scrollTop = chatBox.scrollHeight;
    }

    async function handleSend() {
      const query = promptInput.value.trim();
      const service = serviceSelect.value;
      if (!query) return;

      addMessage(query, "user");
      promptInput.value = "";

      if (service === "gemini") {
        const key = await getGeminiKey();
        if (!key) return addMessage("‚ùå Nenhuma chave Gemini fornecida.");

        addMessage("‚è≥ Consultando Gemini...", "bot");
        try {
          const resp = await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
              "x-goog-api-key": key
            },
            body: JSON.stringify({
              contents: [{ parts: [{ text: query }] }]
            })
          });
          const data = await resp.json();
          const resposta = data?.candidates?.[0]?.content?.parts?.[0]?.text || "‚ùå Nenhuma resposta.";
          addMessage(resposta.replace(/\n/g, "<br>"), "bot");
        } catch (e) {
          addMessage("‚ùå Erro Gemini: " + e.message, "bot");
        }
      }

      if (service === "pinterest") {
        addMessage("‚è≥ Buscando imagens no Pinterest...", "bot");
        try {
          const resp = await fetch(`https://api.pinterest.com/v5/search/pins?query=${encodeURIComponent(query)}`, {
            headers: { "Authorization": "Bearer pina_AMARIYIXADM4MBAAGAAIQDMBWQJZFGIBQBIQC3ZW3QR37AH6DHDZA4WAOKMAM2TTXOMQKEUCYQW3U3NSNPNXI26LX5MG43QA" }
          });
          const data = await resp.json();
          if (data.items?.length) {
            const imgs = data.items.slice(0, 5).map(p => `<img src="${p.images?.orig?.url}" style="max-width:100%; border-radius:8px; margin:4px 0;" />`).join("");
            addMessage(imgs, "bot");
          } else {
            addMessage("‚ùå Nenhum resultado no Pinterest.", "bot");
          }
        } catch (e) {
          addMessage("‚ùå Erro Pinterest: " + e.message, "bot");
        }
      }

      if (service === "youtube") {
        addMessage("‚è≥ Buscando no YouTube...", "bot");
        try {
          const resp = await fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&type=video&maxResults=5&q=${encodeURIComponent(query)}&key=AIzaSyDPKNKLX0kzK-qmGTtEO1dt48QwFTiffZQ`);
          const data = await resp.json();
          if (data.items?.length) {
            const vids = data.items.map(v => {
              const id = v.id.videoId;
              const title = v.snippet.title;
              return `<a href="https://www.youtube.com/watch?v=${id}" target="_blank">‚ñ∂Ô∏è ${title}</a>`;
            }).join("<br>");
            addMessage(vids, "bot");
          } else {
            addMessage("‚ùå Nenhum v√≠deo encontrado.", "bot");
          }
        } catch (e) {
          addMessage("‚ùå Erro YouTube: " + e.message, "bot");
        }
      }

      if (service === "google") {
        const url = `https://cse.google.com/cse?cx=904d3ef2716a3437b&q=${encodeURIComponent(query)}`;
        addMessage(`üîé Resultados dispon√≠veis em: <a href="${url}" target="_blank">${url}</a>`, "bot");
      }
    }

    sendBtn.onclick = handleSend;
    promptInput.addEventListener("keypress", e => {
      if (e.key === "Enter") handleSend();
    });
  </script>
</body>
    </html>
